<html>
  <head>
    <title>Edit: {{ content.heading }} - Thread</title>
    {% include 'scripts.html' %}
  </head>

  <body>
    {% include 'modules/login.html' %}

    <a href="{{ url_for('index') }}">Home</a>

    <h1>
      <span id="name" contenteditable="true">{{ content.heading.name }}</span>, AKA "<span id="aka" contenteditable="true">{{ content.heading.aka }}</span>"
    </h1>
    <a href="{{ url_for('page', title=g.page.title) }}">Back</a>
    <div id="body" contenteditable="true">
      {{ content.summary|safe }}

      {% from 'page-utils.html' import header_at_level %}
      {% for section in content.sections %}
        {{ header_at_level(section.header, section.level) }}
        {{ section.body|safe }}
      {% endfor %}
    </div>
    <button type="button" onclick="submitedit()">Submit edit</button>
    <div id="error-edit"></div>

    <script>
      function submitedit() {
        signal("{{ url_for('submitedit', title=g.page.title) }}", {
          body: document.getElementById("body").innerHTML,
          name: document.getElementById("name").innerText,
          aka: document.getElementById("aka").innerText,
          num_versions: {{ len(g.page.versions) }},
          errorid: 'error-edit',
        });
      }
    </script>

  </body>
</html>
