{% macro header_at_level(header, level) %}
  {% if level == 2 %}
    <h2>{{ header }}</h2>
  {% elif level == 3 %}
    <h3>{{ header }}</h3>
  {% elif level == 4 %}
    <h4>{{ header }}</h4>
  {% elif level == 5 %}
    <h5>{{ header }}</h5>
  {% elif level == 6 %}
    <h6>{{ header }}</h6>
  {% endif %}
{% endmacro %}

{% macro showprimarydiff(primarydiff) %}
  <div>{{ primarydiff.summary|safe }}</div>

  {% from 'page-utils.html' import header_at_level %}
  {% for section in primarydiff.sections %}
    {% if section.inserted %}
      <ins>{{ header_at_level(section.header, section.level) }}</ins>
      <ins>{{ section.body|safe }}</ins>
    {% elif section.deleted %}
      <del>{{ header_at_level(section.header, section.level) }}</del>
      <del>{{ section.body|safe }}</del>
    {% elif section.diff %}
      {{ header_at_level(section.header, section.level) }}
      {{ section.diff|safe }}
    {% else %}
      {{ header_at_level(section.header, section.level) }}
      {{ section.body|safe }}
    {% endif %}
  {% endfor %}
{% endmacro %}

{% macro showheadingdiff(version) %}
  {% if version.primarydiff.headingchanged %}
    <del>{{ version.primarydiff.oldheading }}</del>
  {% endif %}
  {% if version.primarydiff.nicknamechanged %}
    <del>{{ version.primarydiff.oldnickname }}</del>
  {% endif %}
  <h1>{{ version.content.heading }}, AKA "{{ version.content.nickname }}"</h1>
{% endmacro %}
